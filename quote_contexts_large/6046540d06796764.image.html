<!doctype html>
<html lang="en"><head><meta charset="utf-8"><title>Image Context 6046540d06796764</title>
<style>
body{font:14px/1.4 -apple-system,Segoe UI,Roboto,sans-serif;max-width:900px;margin:24px auto;padding:0 16px;color:#222}
h1{font-size:18px;margin:0 0 12px 0}
h2{font-size:16px;margin:16px 0 8px}
h3{font-size:14px;margin:10px 0 4px}
code,pre{background:#f6f8fa;padding:2px 4px;border-radius:4px}
figure{margin:10px 0;padding:8px;border:1px solid #e6e6e6;border-radius:8px}
figcaption{color:#555;font-size:12px;margin-top:6px}
pre {
  white-space: pre-wrap;     /* allow wrapping inside <pre> */
  overflow-wrap: anywhere;   /* break very long words/URLs */
  word-break: break-word;    /* fallback for older engines */
  max-width: 68ch;           /* ~68 characters line length */
  margin: 0 auto 10px;       /* center the block */
  line-height: 1.5;
}

figcaption {
  max-width: 68ch;           /* keep the sentence narrow */
  margin: 6px auto 0;        /* center under the image */
  white-space: normal;       /* ensure wrapping */
  overflow-wrap: anywhere;
  word-break: break-word;
  line-height: 1.5;
}
</style>
</head><body>
  <h1>Image context</h1>
  <p><strong>Search input:</strong></p>
  <pre>4.1.2 WALL</pre>
  <p><strong>Search mode:</strong> paragraph_v &nbsp; <strong>Targeting:</strong> 1.5×</p>

  <h2>Selected image</h2>
  <figure>
    <img src="https://pd12m.s3.us-west-2.amazonaws.com/images/d22f3f99-75a6-5fc7-98c2-42fb523eaeca.jpeg" alt="" style="max-width:100%;height:auto;">
    <figcaption>Region 0 — folly, misty, mist, moss</figcaption>
  </figure>

  <h2>All regions</h2>
  <section style="margin:16px 0;"><h3 style="margin:6px 0;">Region 0 — moss, mist, misty, chateau, folly, bearer, conducting, funeral, folly, misty, mist, moss, funeral, mourner, preaching, pastoral, bulletin, preaching, bearer, buzzer, suspender, cheek, chateau, latch, conductor, express, conductor, express, hassling, buzzer, pastoral, flock, rafter, scoring, scoring, rafter, hassling, batman, veil, mourner, structuralists, obliteration, structuralists, folly, darkened, folly, suspender, chateau, folly, obliteration, folly</h3><ul style="margin:6px 0 0 18px;"><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/b6e917c4-0e5a-5f1f-b236-703aaf86306a.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/b6e917c4-0e5a-5f1f-b236-703aaf86306a.jpeg</a> — moss, mist, misty, chateau, folly</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/3243cde9-574a-597c-ab2b-a6e8ff377e32.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/3243cde9-574a-597c-ab2b-a6e8ff377e32.jpeg</a> — bearer, conducting, funeral</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/d22f3f99-75a6-5fc7-98c2-42fb523eaeca.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/d22f3f99-75a6-5fc7-98c2-42fb523eaeca.jpeg</a> — folly, misty, mist, moss</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/84f6778b-1900-5084-8b3d-6d8466654ef0.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/84f6778b-1900-5084-8b3d-6d8466654ef0.jpeg</a> — funeral, mourner, preaching</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/2e165025-9532-58ab-9f52-b9356554d56e.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/2e165025-9532-58ab-9f52-b9356554d56e.jpeg</a> — pastoral, bulletin, preaching</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/952bef2b-f082-5e9e-858a-01d3a24db88f.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/952bef2b-f082-5e9e-858a-01d3a24db88f.jpeg</a> — bearer, buzzer, suspender</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/3a3d5ac9-8404-5f24-8154-3796c0ddc6ca.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/3a3d5ac9-8404-5f24-8154-3796c0ddc6ca.jpeg</a> — cheek, chateau, latch</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/0d379cac-83b4-5350-ab9c-2fdd05ef9aa8.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/0d379cac-83b4-5350-ab9c-2fdd05ef9aa8.jpeg</a> — conductor, express</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/84852f77-5b60-5d14-9c13-c477317aed16.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/84852f77-5b60-5d14-9c13-c477317aed16.jpeg</a> — conductor, express</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/aa226350-e4c3-5417-a644-82dab20a1a83.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/aa226350-e4c3-5417-a644-82dab20a1a83.jpeg</a> — hassling, buzzer</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/98b7e293-0ba1-53cd-bca6-9ff65d88d2d6.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/98b7e293-0ba1-53cd-bca6-9ff65d88d2d6.jpeg</a> — pastoral, flock</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/396afec9-6eb7-5207-8b5a-2a9ee3a41554.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/396afec9-6eb7-5207-8b5a-2a9ee3a41554.jpeg</a> — rafter, scoring</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/07608fa0-d8c6-5c4a-ac5b-227a4a41f6d9.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/07608fa0-d8c6-5c4a-ac5b-227a4a41f6d9.jpeg</a> — scoring, rafter</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/da4c90d9-a8a9-5564-a260-d01d3bf517be.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/da4c90d9-a8a9-5564-a260-d01d3bf517be.jpeg</a> — hassling, batman</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/1faca6ea-39e0-5fd0-8005-0b36a9fb8a3d.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/1faca6ea-39e0-5fd0-8005-0b36a9fb8a3d.jpeg</a> — veil, mourner</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/2976fd61-28a7-50de-b273-237604cb7273.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/2976fd61-28a7-50de-b273-237604cb7273.jpeg</a> — structuralists, obliteration</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/2b4ab021-8d6f-5cf9-9084-1d009f7fc9df.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/2b4ab021-8d6f-5cf9-9084-1d009f7fc9df.jpeg</a> — structuralists, folly</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/a7bc84ed-75cf-54bc-94ea-be1f51234b14.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/a7bc84ed-75cf-54bc-94ea-be1f51234b14.jpeg</a> — darkened, folly</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/34cc2fdd-53cc-5609-9a10-036ed5655a52.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/34cc2fdd-53cc-5609-9a10-036ed5655a52.jpeg</a> — suspender, chateau, folly</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/78cf1e0a-67fc-590c-9ca7-9c4757a2ac8b.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/78cf1e0a-67fc-590c-9ca7-9c4757a2ac8b.jpeg</a> — obliteration, folly</li></ul></section>
<section style="margin:16px 0;"><h3 style="margin:6px 0;">Region 1 — grassy, timeworn, confetti, cemetery, escorted, grassy, flapping, flight, escorted, cemetery, timeworn, mowed, flight, flapping, accelerated, tearfully, unsinkable, search, briefing, manly, heterosexuality, notepad, confetti, keynote, briefing, organize, employer, organize, accelerated, eradicate, kissed, kissed, eradicate, mowed, mansion, grassy, surname, slavery, beverage, grilling, mast, dial, spilling, beverage, bombardier, flight</h3><ul style="margin:6px 0 0 18px;"><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/f5f9ad92-7cf8-50ec-b1bd-c5898bb9c818.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/f5f9ad92-7cf8-50ec-b1bd-c5898bb9c818.jpeg</a> — grassy, timeworn, confetti</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/2c10ca9e-1019-5bcf-9ef9-1b46077e288b.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/2c10ca9e-1019-5bcf-9ef9-1b46077e288b.jpeg</a> — cemetery, escorted, grassy</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/13baa299-4531-56d9-baa5-989c4364f037.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/13baa299-4531-56d9-baa5-989c4364f037.jpeg</a> — flapping, flight, escorted</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/2eae1f6c-5069-53d8-800a-a6dc9163077b.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/2eae1f6c-5069-53d8-800a-a6dc9163077b.jpeg</a> — cemetery, timeworn, mowed</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/96befe42-f58a-5d2f-9351-002f0f284b38.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/96befe42-f58a-5d2f-9351-002f0f284b38.jpeg</a> — flight, flapping, accelerated</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/675e2f64-2728-519e-a217-a922007adce6.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/675e2f64-2728-519e-a217-a922007adce6.jpeg</a> — tearfully, unsinkable</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/5c75328d-cf36-5cb0-9082-68c143d9e737.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/5c75328d-cf36-5cb0-9082-68c143d9e737.jpeg</a> — search, briefing</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/f9178f87-af2e-5a23-b16a-a84b1437f240.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/f9178f87-af2e-5a23-b16a-a84b1437f240.jpeg</a> — manly, heterosexuality</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/5413b949-b83b-55ce-8f8e-826b54f0de2e.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/5413b949-b83b-55ce-8f8e-826b54f0de2e.jpeg</a> — notepad, confetti</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/db11b536-d660-5018-baef-2746c03c4a45.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/db11b536-d660-5018-baef-2746c03c4a45.jpeg</a> — keynote, briefing</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/314707bf-8e20-54ce-a29b-46a2da3b3020.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/314707bf-8e20-54ce-a29b-46a2da3b3020.jpeg</a> — organize, employer</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/6d782efe-65b3-5b42-8496-4f7220b6cf22.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/6d782efe-65b3-5b42-8496-4f7220b6cf22.jpeg</a> — organize, accelerated</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/e8d8a163-59b5-5ad1-b2fd-c630ed6eb9b5.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/e8d8a163-59b5-5ad1-b2fd-c630ed6eb9b5.jpeg</a> — eradicate, kissed</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/66d1b881-f19b-5dd5-9ab3-575c297ee718.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/66d1b881-f19b-5dd5-9ab3-575c297ee718.jpeg</a> — kissed, eradicate</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/a3b8ef95-5f43-5751-8bf8-536b9c5d08fb.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/a3b8ef95-5f43-5751-8bf8-536b9c5d08fb.jpeg</a> — mowed, mansion, grassy</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/4afaac59-4f30-54b5-b4e9-b4cd7783600e.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/4afaac59-4f30-54b5-b4e9-b4cd7783600e.jpeg</a> — surname, slavery</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/2e259b3a-2f01-577f-8468-3e6f45180003.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/2e259b3a-2f01-577f-8468-3e6f45180003.jpeg</a> — beverage, grilling</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/35018ce7-254c-55b8-befc-c431021c2366.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/35018ce7-254c-55b8-befc-c431021c2366.jpeg</a> — mast, dial</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/71381d31-ddfb-5ffa-8f28-5b2875b732ce.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/71381d31-ddfb-5ffa-8f28-5b2875b732ce.jpeg</a> — spilling, beverage</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/f7ca539b-c2a0-5119-8001-44e2b263b7ce.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/f7ca539b-c2a0-5119-8001-44e2b263b7ce.jpeg</a> — bombardier, flight</li></ul></section>
<section style="margin:16px 0;"><h3 style="margin:6px 0;">Region 2 — roost, consecutive, sky, flew, flew, resting, sprite, fluttery, replica, score, preserved, guard, jujube, preserved, replica, guard, score, officer, marshal, consecutive, sprite, fluttery, resting, shocked, weeping, salute, officer, marshal, dame, zonked, thirsty, curve, encountering, ending, jolt, thirsty, jacketed, jujube, dame, dickens, compass, rounded, jolt, jacketed, ending, sky, provoked, kamikaze, orchestra, ohm</h3><ul style="margin:6px 0 0 18px;"><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/18d4949e-47a7-5c5e-ac5f-e83ae24cc826.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/18d4949e-47a7-5c5e-ac5f-e83ae24cc826.jpeg</a> — roost, consecutive, sky, flew</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/e9e8ad42-b899-58b7-96a1-9299c4ec8a1d.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/e9e8ad42-b899-58b7-96a1-9299c4ec8a1d.jpeg</a> — flew, resting, sprite, fluttery</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/681de894-9624-51db-ab0b-9a113dd9b033.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/681de894-9624-51db-ab0b-9a113dd9b033.jpeg</a> — replica, score, preserved</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/a323f587-c060-5844-b892-94851d5eb661.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/a323f587-c060-5844-b892-94851d5eb661.jpeg</a> — guard, jujube, preserved</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/dcf4be40-e001-5c39-a46a-0eebf6b2a5be.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/dcf4be40-e001-5c39-a46a-0eebf6b2a5be.jpeg</a> — replica, guard, score</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/f1f407a2-5518-5902-9179-6ca5221f1cd2.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/f1f407a2-5518-5902-9179-6ca5221f1cd2.jpeg</a> — officer, marshal, consecutive</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/66b2638c-af8f-5531-995e-9271e9c8ccd4.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/66b2638c-af8f-5531-995e-9271e9c8ccd4.jpeg</a> — sprite, fluttery, resting</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/c7beb2eb-dd45-513d-a8af-2e97dabd0ec6.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/c7beb2eb-dd45-513d-a8af-2e97dabd0ec6.jpeg</a> — shocked, weeping</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/ea38efea-7b10-5e67-bd96-563787ef7014.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/ea38efea-7b10-5e67-bd96-563787ef7014.jpeg</a> — salute, officer, marshal</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/f2cad144-6e44-5e0d-98dd-fb33eda90c82.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/f2cad144-6e44-5e0d-98dd-fb33eda90c82.jpeg</a> — dame, zonked</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/6f9f2c8a-5341-5da8-a94a-32ae08d5f761.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/6f9f2c8a-5341-5da8-a94a-32ae08d5f761.jpeg</a> — thirsty, curve</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/a670deba-6932-5e32-ae2e-dc4aeda48df5.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/a670deba-6932-5e32-ae2e-dc4aeda48df5.jpeg</a> — encountering, ending</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/e3507b0f-5fe8-5c4c-a101-ccca11d93268.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/e3507b0f-5fe8-5c4c-a101-ccca11d93268.jpeg</a> — jolt, thirsty</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/b4446905-c45d-5a74-84c2-e80b07dab5ca.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/b4446905-c45d-5a74-84c2-e80b07dab5ca.jpeg</a> — jacketed, jujube</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/a455c93f-8ea1-58bf-b413-e13fd165312d.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/a455c93f-8ea1-58bf-b413-e13fd165312d.jpeg</a> — dame, dickens</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/35fe5b0e-1bc6-5780-bb09-62a269ece44f.png" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/35fe5b0e-1bc6-5780-bb09-62a269ece44f.png</a> — compass, rounded</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/1e7a8fdb-67a1-53ff-b601-a23aafcb5ed2.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/1e7a8fdb-67a1-53ff-b601-a23aafcb5ed2.jpeg</a> — jolt, jacketed</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/92d75c3c-aebf-53c0-9c1b-d5bd0c6a8b42.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/92d75c3c-aebf-53c0-9c1b-d5bd0c6a8b42.jpeg</a> — ending, sky</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/d92c557c-62ce-55d8-9644-37a054c0699a.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/d92c557c-62ce-55d8-9644-37a054c0699a.jpeg</a> — provoked, kamikaze</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/6963153a-3d50-5893-b858-cfa17fa16418.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/6963153a-3d50-5893-b858-cfa17fa16418.jpeg</a> — orchestra, ohm</li></ul></section>
<style>
  /* Region dropdowns */
  details.region {
    margin: 16px 0;
    border: 1px solid #e6e6e6;
    border-radius: 10px;
    padding: 8px 10px;
    background: #fff;
  }
  details.region > summary {
    cursor: pointer;
    font-weight: 600;
    list-style: none;
    outline: none;
  }
  details.region > summary::-webkit-details-marker { display: none; }
  details.region[open] > summary { margin-bottom: 8px; }

  /* Secondary (inline preview) dropdowns under each link */
  details.secondary {
    margin-top: 6px;
    border-left: 3px solid #e6e6e6;
    padding-left: 10px;
  }
  details.secondary > summary {
    cursor: pointer;
    font-size: 12px;
    color: #444;
    list-style: none;
    outline: none;
  }
  details.secondary > summary::-webkit-details-marker { display: none; }

  .secondary-status {
    font-size: 12px;
    color: #666;
    margin: 6px 0;
  }
  .secondary-embed {
    border: 1px solid #eee;
    border-radius: 8px;
    padding: 8px;
    overflow: auto;
    max-height: 70vh;
    background: #fafafa;
  }
  details.region ul { padding-left: 0; }
  details.region li {
    list-style: none;
    display: flex;
    gap: 10px;
    align-items: flex-start;
    margin: 10px 0;
  }

  a.thumb-link { display: inline-block; }
  img.thumb {
    display: block;
    width: 140px;          /* tweak as desired */
    height: auto;
    border: 1px solid #e6e6e6;
    border-radius: 10px;
    background: #fff;
  }

  /* If you want the caption text to wrap nicely next to the thumb */
  .thumb-caption {
    line-height: 1.25;
  }
</style>

<script>
(() => {
  /**
   * Controls behaviour:
   * - If true: when a REGION opens, prefetch all secondary HTML previews in that region.
   * - If false (default): only fetch when the per-link “Inline preview” dropdown is opened
   *   (still satisfies “only when region is expanded”, because you can’t open the preview otherwise).
   */
  const PRELOAD_ON_REGION_OPEN = false;

  // Consider a link “secondary HTML” if it ends with .html/.htm/.xhtml
  // OR if you explicitly mark it with class="secondary-link" or data-secondary="1".
  const SECONDARY_RE = /\.(?:xhtml|html?|htm)(?:[?#].*)?$/i;
  const IMG_RE = /\.(?:png|jpe?g|gif|webp|svg)(?:[?#].*)?$/i;

  // Cache fetches so repeated opens don't refetch the same page.
  const fetchCache = new Map(); // url -> Promise<string>

  function hydrateImageThumbnails(regionDetails) {
  const anchors = Array.from(regionDetails.querySelectorAll("a[href]"));

  for (const a of anchors) {
    const href = a.getAttribute("href") || "";
    if (!IMG_RE.test(href)) continue;

    // If already an image (e.g., you manually made one), skip.
    if (a.querySelector("img")) continue;

    // Make the link open the full image in a new tab (optional but usually nicer)
    a.target = "_blank";
    a.rel = "noopener";
    a.classList.add("thumb-link");

    // Preserve any trailing text after the link (your " — tags" etc.)
    // by wrapping it into a span so layout stays clean.
    const li = a.closest("li");
    if (li) {
      // Everything after the <a> currently sits as text nodes in the <li>.
      // We'll keep it, but wrap it so it sits next to the image neatly.
      // Only do this once.
      if (!li.querySelector(":scope > .thumb-caption")) {
        const caption = document.createElement("div");
        caption.className = "thumb-caption";

        // Move all nodes after <a> into caption
        let node = a.nextSibling;
        while (node) {
          const next = node.nextSibling;
          caption.appendChild(node);
          node = next;
        }
        li.appendChild(caption);
      }
    }

    // Replace link text with an <img> thumbnail.
    a.textContent = ""; // removes the URL/filename display

    const img = document.createElement("img");
    img.className = "thumb";
    img.loading = "lazy";
    img.decoding = "async";

    // Alt from filename (basic)
    try {
      const u = new URL(href, window.location.href);
      img.alt = (u.pathname.split("/").pop() || "image").replace(/[-_]/g, " ");
    } catch {
      img.alt = "image";
    }

    // Critical: only set src when region is open (this function is called on open)
    img.src = href;

    a.appendChild(img);
  }
}


  function fetchText(url) {
    if (!fetchCache.has(url)) {
      fetchCache.set(url, fetch(url, { cache: "force-cache" }).then(r => {
        if (!r.ok) throw new Error(`HTTP ${r.status}`);
        return r.text();
      }));
    }
    return fetchCache.get(url);
  }

  function extractForEmbed(htmlText) {
    const parser = new DOMParser();
    const doc = parser.parseFromString(htmlText, "text/html");

    // Remove scripts for safety and to avoid side-effects.
    doc.querySelectorAll("script").forEach(s => s.remove());

    // Collect inline <style> blocks.
    const styles = Array.from(doc.querySelectorAll("style"))
      .map(s => s.textContent || "")
      .join("\n");

    // Remove styles/links from body so they don't pollute the parent page.
    doc.body.querySelectorAll("style, link[rel='stylesheet']").forEach(n => n.remove());

    return { styles, content: doc.body.innerHTML, title: doc.title || "" };
  }

  function isSecondaryLink(a) {
    const href = a.getAttribute("href") || "";
    if (!href) return false;
    if (IMG_RE.test(href)) return false;

    return (
      SECONDARY_RE.test(href) ||
      a.dataset.secondary === "1" ||
      a.classList.contains("secondary-link")
    );
  }

  function ensureSecondaryPreviewUI(a) {
    const li = a.closest("li");
    if (!li) return;
    if (li.querySelector(":scope > details.secondary")) return;

    const href = a.getAttribute("href");

    const details = document.createElement("details");
    details.className = "secondary";

    // Minimal UI; embed area is filled on demand.
    details.innerHTML = `
      <summary>Inline preview</summary>
      <div class="secondary-status">Not loaded.</div>
      <div class="secondary-embed" data-href="${href.replace(/"/g, "&quot;")}"></div>
    `;

    li.appendChild(details);

    details.addEventListener("toggle", async () => {
      if (!details.open) return;

      const embed = details.querySelector(".secondary-embed");
      if (!embed || embed.dataset.loaded === "1") return;

      // Important: only load if the enclosing region is open (your requirement).
      const region = details.closest("details.region");
      if (!region || !region.open) return;

      const status = details.querySelector(".secondary-status");
      const url = embed.dataset.href;

      try {
        status.textContent = "Loading…";
        const htmlText = await fetchText(url);
        const { styles, content } = extractForEmbed(htmlText);

        // Shadow DOM isolates the embedded page's CSS so it doesn't leak into the parent.
        if (embed.attachShadow) {
          const root = embed.attachShadow({ mode: "open" });
          root.innerHTML = `
            <style>
              :host { display: block; }
              /* light reset inside the embedded view */
              body { margin: 0; }
            </style>
            <style>${styles}</style>
            <div class="embedded">${content}</div>
          `;
        } else {
          // Fallback: no isolation (older browsers).
          embed.innerHTML = `<div class="embedded">${content}</div>`;
        }

        embed.dataset.loaded = "1";
        status.textContent = "Loaded.";
      } catch (err) {
        status.textContent = `Failed to load (${url}): ${err.message || err}`;
      }
    });
  }

  function convertRegionSectionsToDetails() {
    document.querySelectorAll("section").forEach(sec => {
      const h3 = sec.querySelector(":scope > h3");
      const ul = sec.querySelector(":scope > ul");
      if (!h3 || !ul) return;

      const title = (h3.textContent || "").trim();
      if (!/^Region\b/i.test(title)) return;

      const details = document.createElement("details");
      details.className = "region";
      if (sec.getAttribute("style")) details.setAttribute("style", sec.getAttribute("style"));

      const summary = document.createElement("summary");
      summary.textContent = title;

      const body = document.createElement("div");
      body.className = "region-body";

      // Move <ul> into the dropdown body.
      body.appendChild(ul);

      details.appendChild(summary);
      details.appendChild(body);

      // Replace the entire section (drops the old h3).
      sec.replaceWith(details);
    });
  }

  async function onRegionOpen(regionDetails) {
  if (regionDetails.dataset.hydrated === "1") return;
  regionDetails.dataset.hydrated = "1";

  // NEW: turn image links into thumbnails (only loads now, on open)
  hydrateImageThumbnails(regionDetails);

  // Keep your existing HTML-inline-preview behaviour (if you still want it)
  const anchors = Array.from(regionDetails.querySelectorAll("a[href]"))
    .filter(isSecondaryLink);

  anchors.forEach(ensureSecondaryPreviewUI);

  if (PRELOAD_ON_REGION_OPEN) { /* unchanged */ }
}


  document.addEventListener("DOMContentLoaded", () => {
    convertRegionSectionsToDetails();

    document.querySelectorAll("details.region").forEach(d => {
      d.addEventListener("toggle", () => {
        if (d.open) onRegionOpen(d);
      });
    });
  });
})();
</script>

</body></html>
