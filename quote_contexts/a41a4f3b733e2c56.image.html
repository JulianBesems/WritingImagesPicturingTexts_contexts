<!doctype html>
<html lang="en"><head><meta charset="utf-8"><title>Image Context a41a4f3b733e2c56</title>
<style>
body{font:14px/1.4 -apple-system,Segoe UI,Roboto,sans-serif;max-width:900px;margin:24px auto;padding:0 16px;color:#222}
h1{font-size:18px;margin:0 0 12px 0}
h2{font-size:16px;margin:16px 0 8px}
h3{font-size:14px;margin:10px 0 4px}
code,pre{background:#f6f8fa;padding:2px 4px;border-radius:4px}
figure{margin:10px 0;padding:8px;border:1px solid #e6e6e6;border-radius:8px}
figcaption{color:#555;font-size:12px;margin-top:6px}
pre {
  white-space: pre-wrap;     /* allow wrapping inside <pre> */
  overflow-wrap: anywhere;   /* break very long words/URLs */
  word-break: break-word;    /* fallback for older engines */
  max-width: 68ch;           /* ~68 characters line length */
  margin: 0 auto 10px;       /* center the block */
  line-height: 1.5;
}

figcaption {
  max-width: 68ch;           /* keep the sentence narrow */
  margin: 6px auto 0;        /* center under the image */
  white-space: normal;       /* ensure wrapping */
  overflow-wrap: anywhere;
  word-break: break-word;
  line-height: 1.5;
}
</style>
</head><body>
  <h1>Image context</h1>
  <p><strong>Search input:</strong></p>
  <pre>The signicance of a walls threshold qualities notwithstanding, a wall is empirically also a screen, or cover; a function of particular importance to medieval and premodern urban Arab-Muslim culture, with its traditional enclaustration and veiling of women.</pre>
  <p><strong>Search mode:</strong> paragraph_v &nbsp; <strong>Targeting:</strong> 1.5×</p>

  <h2>Selected image</h2>
  <figure>
    <img src="https://pd12m.s3.us-west-2.amazonaws.com/images/e611b99c-0aad-5a91-ae56-e688f1fbba40.jpeg" alt="" style="max-width:100%;height:auto;">
    <figcaption>Region 0 — archiving, cooperate</figcaption>
  </figure>

  <h2>All regions</h2>
  <section style="margin:16px 0;"><h3 style="margin:6px 0;">Region 0 — psychoanalysis, psychotherapy, disquiet, manifesto, scribbled, psychoanalysis, scribbled, psychotherapy, archiving, misconduct, eavesdropping, inspecting, repairman, restoring, archiving, inspecting, inspection, feuding, conversing, negotiation, inspection, conversing, negotiation, restoring, repairman, eavesdropping, notary, pawnshop, bookkeeper, notary, imperceptible, snakeskin, snakeskin, imperceptible, poultice, mandrake, bookkeeper, proofreader, wreath, cooperate, ballad, disquiet, mandrake, wreath, dowry, showered, archiving, defendant, archiving, defendant, archiving, cooperate</h3><ul style="margin:6px 0 0 18px;"><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/b3efed29-fa8d-57d3-80a6-ef154ce7ce7f.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/b3efed29-fa8d-57d3-80a6-ef154ce7ce7f.jpeg</a> — psychoanalysis, psychotherapy, disquiet, manifesto, scribbled</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/965edb49-1566-5a4a-8801-b12a3041c817.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/965edb49-1566-5a4a-8801-b12a3041c817.jpeg</a> — psychoanalysis, scribbled, psychotherapy, archiving</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/1439cee5-e120-5e09-89a0-19eae9d6a2d7.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/1439cee5-e120-5e09-89a0-19eae9d6a2d7.jpeg</a> — misconduct, eavesdropping, inspecting, repairman</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/007f0955-a1c3-52e2-a97c-34de74e52fd8.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/007f0955-a1c3-52e2-a97c-34de74e52fd8.jpeg</a> — restoring, archiving, inspecting, inspection</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/a1cf45c5-71a3-51ff-9466-52cf292daa5f.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/a1cf45c5-71a3-51ff-9466-52cf292daa5f.jpeg</a> — feuding, conversing, negotiation</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/5f4164ec-01ec-5efb-adc2-253e465f8a55.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/5f4164ec-01ec-5efb-adc2-253e465f8a55.jpeg</a> — inspection, conversing, negotiation</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/779ace1b-9dac-58c7-9353-72dbce322230.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/779ace1b-9dac-58c7-9353-72dbce322230.jpeg</a> — restoring, repairman, eavesdropping</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/5c232ac5-9208-5cf4-b2a8-1a6a7c7be7e7.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/5c232ac5-9208-5cf4-b2a8-1a6a7c7be7e7.jpeg</a> — notary, pawnshop</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/20723488-d2e7-56d4-9a66-b59c335e2ea3.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/20723488-d2e7-56d4-9a66-b59c335e2ea3.jpeg</a> — bookkeeper, notary</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/c0f87ade-ab24-5900-9a05-34beff24b17c.png" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/c0f87ade-ab24-5900-9a05-34beff24b17c.png</a> — imperceptible, snakeskin</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/3a6bad5a-9123-5d8c-8ff0-0dac96554a18.png" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/3a6bad5a-9123-5d8c-8ff0-0dac96554a18.png</a> — snakeskin, imperceptible</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/47edfa6f-df84-5474-ae67-cea270097c6e.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/47edfa6f-df84-5474-ae67-cea270097c6e.jpeg</a> — poultice, mandrake</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/ce5326c5-2426-518d-8661-04fa7d1f446a.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/ce5326c5-2426-518d-8661-04fa7d1f446a.jpeg</a> — bookkeeper, proofreader</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/b2b0349c-64f2-5e0b-9e08-5fc10b0f8685.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/b2b0349c-64f2-5e0b-9e08-5fc10b0f8685.jpeg</a> — wreath, cooperate</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/5055144e-2aa1-5678-92ac-87dc9838116a.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/5055144e-2aa1-5678-92ac-87dc9838116a.jpeg</a> — ballad, disquiet</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/662c1db4-fae0-516b-9583-574f0e4fcebf.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/662c1db4-fae0-516b-9583-574f0e4fcebf.jpeg</a> — mandrake, wreath</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/c1afb070-d422-537c-9471-05927ca2dc0f.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/c1afb070-d422-537c-9471-05927ca2dc0f.jpeg</a> — dowry, showered</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/90d5e422-e729-501e-83e9-173b684e8f7b.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/90d5e422-e729-501e-83e9-173b684e8f7b.jpeg</a> — archiving, defendant</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/eb955500-c748-5a34-b874-314d0f0b06dc.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/eb955500-c748-5a34-b874-314d0f0b06dc.jpeg</a> — archiving, defendant</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/e611b99c-0aad-5a91-ae56-e688f1fbba40.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/e611b99c-0aad-5a91-ae56-e688f1fbba40.jpeg</a> — archiving, cooperate</li></ul></section>
<section style="margin:16px 0;"><h3 style="margin:6px 0;">Region 1 — bookmark, lettering, stone, designation, sundial, lettering, stone, designation, cataloguing, gazette, corbel, millimetre, gazette, credenza, cataloguing, oblique, microfilm, sundial, corbel, note, umlaut, hammer, credenza, tailoring, lettering, spelling, umlaut, bondage, tailoring, continental, inheritance, folder, bookmark, microfilm, continental, bondage, brassiere, corbel, engagement, typo, brassiere, stone, inheritance, designation, ethereal, blond, ethereal, blond, oblique, rubbing, flaming, siren, stone, torso, siren</h3><ul style="margin:6px 0 0 18px;"><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/fbf9972f-5c06-5fc2-a6da-7a6d3bd17a8b.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/fbf9972f-5c06-5fc2-a6da-7a6d3bd17a8b.jpeg</a> — bookmark, lettering, stone, designation</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/24b2095a-4585-5fd1-97b1-7f660547151b.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/24b2095a-4585-5fd1-97b1-7f660547151b.jpeg</a> — sundial, lettering, stone, designation</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/e4eca7ac-0845-598f-a8b1-3eb3c0931155.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/e4eca7ac-0845-598f-a8b1-3eb3c0931155.jpeg</a> — cataloguing, gazette, corbel, millimetre</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/ba3b5f8e-4e16-5f21-b915-05d27f97aaed.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/ba3b5f8e-4e16-5f21-b915-05d27f97aaed.jpeg</a> — gazette, credenza, cataloguing</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/f9568afc-1a45-5d3c-9c25-62966c0fc765.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/f9568afc-1a45-5d3c-9c25-62966c0fc765.jpeg</a> — oblique, microfilm, sundial, corbel</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/81a6d160-552c-5fa9-9c07-30680644939c.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/81a6d160-552c-5fa9-9c07-30680644939c.jpeg</a> — note, umlaut, hammer</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/05158d80-7359-59ce-8c8f-c720599f90c3.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/05158d80-7359-59ce-8c8f-c720599f90c3.jpeg</a> — credenza, tailoring</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/2e76e691-4495-507d-96b2-072a9156b39c.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/2e76e691-4495-507d-96b2-072a9156b39c.jpeg</a> — lettering, spelling, umlaut</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/2002ffc4-9fd6-5a8a-8ca0-d53c29471f19.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/2002ffc4-9fd6-5a8a-8ca0-d53c29471f19.jpeg</a> — bondage, tailoring</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/7ea1c327-10e0-5077-a0fa-f57dc251bb4c.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/7ea1c327-10e0-5077-a0fa-f57dc251bb4c.jpeg</a> — continental, inheritance</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/c266c1e5-f1d0-55ad-b411-34436a1377c5.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/c266c1e5-f1d0-55ad-b411-34436a1377c5.jpeg</a> — folder, bookmark</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/3081b3d9-74e2-57c0-a392-b8ce9f07dddd.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/3081b3d9-74e2-57c0-a392-b8ce9f07dddd.jpeg</a> — microfilm, continental</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/e67c00b8-3813-5c9c-9b13-678a1d617d4e.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/e67c00b8-3813-5c9c-9b13-678a1d617d4e.jpeg</a> — bondage, brassiere, corbel</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/f9178f87-af2e-5a23-b16a-a84b1437f240.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/f9178f87-af2e-5a23-b16a-a84b1437f240.jpeg</a> — engagement, typo</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/443dfdbf-d113-5319-ab31-bea34a2f5f9f.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/443dfdbf-d113-5319-ab31-bea34a2f5f9f.jpeg</a> — brassiere, stone, inheritance, designation</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/37e9faef-4f43-59bb-a3a0-c129375e03f0.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/37e9faef-4f43-59bb-a3a0-c129375e03f0.jpeg</a> — ethereal, blond</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/a2b59d4c-097a-5b86-be36-1ae9c3f045b8.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/a2b59d4c-097a-5b86-be36-1ae9c3f045b8.jpeg</a> — ethereal, blond</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/4b2ead6f-9856-5302-9dd1-8c5d94026787.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/4b2ead6f-9856-5302-9dd1-8c5d94026787.jpeg</a> — oblique, rubbing</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/deea9da1-fc16-53e9-b156-e531361aeb83.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/deea9da1-fc16-53e9-b156-e531361aeb83.jpeg</a> — flaming, siren</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/4086a025-5e97-59e6-9663-c1a50a22ac5b.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/4086a025-5e97-59e6-9663-c1a50a22ac5b.jpeg</a> — stone, torso, siren</li></ul></section>
<section style="margin:16px 0;"><h3 style="margin:6px 0;">Region 2 — arm, advising, shouldering, adverting, mac, advertisement, advertisement, adverting, mac, face, dentist, wheezing, arm, shouldering, enable, prism, laundering, closet, ribbon, closet, prism, daydream, enable, daydream, shoplift, shoplifting, shoplift, shoplifting, spilling, spill, deadbolt, tanning, birthmark, tanning, goldfish, stabilize, versa, beneath, flattering, face, ribbon, credential, stabilize, overacted</h3><ul style="margin:6px 0 0 18px;"><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/7f092cb0-639f-50c9-9d6f-164baa1c7764.png" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/7f092cb0-639f-50c9-9d6f-164baa1c7764.png</a> — arm, advising, shouldering</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/b92583c2-de11-5976-817a-85043d54d9bf.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/b92583c2-de11-5976-817a-85043d54d9bf.jpeg</a> — adverting, mac, advertisement</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/249f77b7-69ce-5aa4-8428-8b936c7395ce.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/249f77b7-69ce-5aa4-8428-8b936c7395ce.jpeg</a> — advertisement, adverting, mac</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/12d66983-d932-523c-8419-f9e204593ac1.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/12d66983-d932-523c-8419-f9e204593ac1.jpeg</a> — face, dentist, wheezing</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/c6145009-f7c5-5e50-8526-dba4c986a38c.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/c6145009-f7c5-5e50-8526-dba4c986a38c.jpeg</a> — arm, shouldering</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/8d882c24-bafc-5d5b-877d-d8cee7c53824.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/8d882c24-bafc-5d5b-877d-d8cee7c53824.jpeg</a> — enable, prism</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/1004f049-2698-54d0-9ffe-1b34e881211f.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/1004f049-2698-54d0-9ffe-1b34e881211f.jpeg</a> — laundering, closet</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/dd4735b7-ae46-5653-ba49-94c14f952106.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/dd4735b7-ae46-5653-ba49-94c14f952106.jpeg</a> — ribbon, closet</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/dea37451-4a09-547f-963e-e984dd255f49.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/dea37451-4a09-547f-963e-e984dd255f49.jpeg</a> — prism, daydream</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/1aeab883-2f6d-597f-91c6-dcdf59d256fd.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/1aeab883-2f6d-597f-91c6-dcdf59d256fd.jpeg</a> — enable, daydream</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/6410bb89-4958-5e35-894d-bf3f1722e7e3.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/6410bb89-4958-5e35-894d-bf3f1722e7e3.jpeg</a> — shoplift, shoplifting</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/32fcd4ea-108c-5ce1-addb-b42afbe5ffb1.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/32fcd4ea-108c-5ce1-addb-b42afbe5ffb1.jpeg</a> — shoplift, shoplifting</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/9039a329-2211-5550-aad1-938ba5b8eb4d.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/9039a329-2211-5550-aad1-938ba5b8eb4d.jpeg</a> — spilling, spill</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/d8e3e221-255f-5ee3-9d42-2eb90793b9f9.png" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/d8e3e221-255f-5ee3-9d42-2eb90793b9f9.png</a> — deadbolt, tanning</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/755eef59-aec9-5eb7-bb4a-59d48b45dd64.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/755eef59-aec9-5eb7-bb4a-59d48b45dd64.jpeg</a> — birthmark, tanning</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/9e88da37-d4b5-5d57-a72e-5b7c377cdd02.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/9e88da37-d4b5-5d57-a72e-5b7c377cdd02.jpeg</a> — goldfish, stabilize</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/ed25112f-6e00-56f5-ac29-dda934cd24ef.png" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/ed25112f-6e00-56f5-ac29-dda934cd24ef.png</a> — versa, beneath</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/c39e28c4-284b-58b7-a845-99cee6806f7e.png" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/c39e28c4-284b-58b7-a845-99cee6806f7e.png</a> — flattering, face</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/12e4a8b2-40db-52b6-83fe-3cbea391a81f.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/12e4a8b2-40db-52b6-83fe-3cbea391a81f.jpeg</a> — ribbon, credential</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/7d99ec9a-2635-54b3-abca-c3f755b10f45.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/7d99ec9a-2635-54b3-abca-c3f755b10f45.jpeg</a> — stabilize, overacted</li></ul></section>
<style>
  /* Region dropdowns */
  details.region {
    margin: 16px 0;
    border: 1px solid #e6e6e6;
    border-radius: 10px;
    padding: 8px 10px;
    background: #fff;
  }
  details.region > summary {
    cursor: pointer;
    font-weight: 600;
    list-style: none;
    outline: none;
  }
  details.region > summary::-webkit-details-marker { display: none; }
  details.region[open] > summary { margin-bottom: 8px; }

  /* Secondary (inline preview) dropdowns under each link */
  details.secondary {
    margin-top: 6px;
    border-left: 3px solid #e6e6e6;
    padding-left: 10px;
  }
  details.secondary > summary {
    cursor: pointer;
    font-size: 12px;
    color: #444;
    list-style: none;
    outline: none;
  }
  details.secondary > summary::-webkit-details-marker { display: none; }

  .secondary-status {
    font-size: 12px;
    color: #666;
    margin: 6px 0;
  }
  .secondary-embed {
    border: 1px solid #eee;
    border-radius: 8px;
    padding: 8px;
    overflow: auto;
    max-height: 70vh;
    background: #fafafa;
  }
  details.region ul { padding-left: 0; }
  details.region li {
    list-style: none;
    display: flex;
    gap: 10px;
    align-items: flex-start;
    margin: 10px 0;
  }

  a.thumb-link { display: inline-block; }
  img.thumb {
    display: block;
    width: 140px;          /* tweak as desired */
    height: auto;
    border: 1px solid #e6e6e6;
    border-radius: 10px;
    background: #fff;
  }

  /* If you want the caption text to wrap nicely next to the thumb */
  .thumb-caption {
    line-height: 1.25;
  }
</style>

<script>
(() => {
  /**
   * Controls behaviour:
   * - If true: when a REGION opens, prefetch all secondary HTML previews in that region.
   * - If false (default): only fetch when the per-link “Inline preview” dropdown is opened
   *   (still satisfies “only when region is expanded”, because you can’t open the preview otherwise).
   */
  const PRELOAD_ON_REGION_OPEN = false;

  // Consider a link “secondary HTML” if it ends with .html/.htm/.xhtml
  // OR if you explicitly mark it with class="secondary-link" or data-secondary="1".
  const SECONDARY_RE = /\.(?:xhtml|html?|htm)(?:[?#].*)?$/i;
  const IMG_RE = /\.(?:png|jpe?g|gif|webp|svg)(?:[?#].*)?$/i;

  // Cache fetches so repeated opens don't refetch the same page.
  const fetchCache = new Map(); // url -> Promise<string>

  function hydrateImageThumbnails(regionDetails) {
  const anchors = Array.from(regionDetails.querySelectorAll("a[href]"));

  for (const a of anchors) {
    const href = a.getAttribute("href") || "";
    if (!IMG_RE.test(href)) continue;

    // If already an image (e.g., you manually made one), skip.
    if (a.querySelector("img")) continue;

    // Make the link open the full image in a new tab (optional but usually nicer)
    a.target = "_blank";
    a.rel = "noopener";
    a.classList.add("thumb-link");

    // Preserve any trailing text after the link (your " — tags" etc.)
    // by wrapping it into a span so layout stays clean.
    const li = a.closest("li");
    if (li) {
      // Everything after the <a> currently sits as text nodes in the <li>.
      // We'll keep it, but wrap it so it sits next to the image neatly.
      // Only do this once.
      if (!li.querySelector(":scope > .thumb-caption")) {
        const caption = document.createElement("div");
        caption.className = "thumb-caption";

        // Move all nodes after <a> into caption
        let node = a.nextSibling;
        while (node) {
          const next = node.nextSibling;
          caption.appendChild(node);
          node = next;
        }
        li.appendChild(caption);
      }
    }

    // Replace link text with an <img> thumbnail.
    a.textContent = ""; // removes the URL/filename display

    const img = document.createElement("img");
    img.className = "thumb";
    img.loading = "lazy";
    img.decoding = "async";

    // Alt from filename (basic)
    try {
      const u = new URL(href, window.location.href);
      img.alt = (u.pathname.split("/").pop() || "image").replace(/[-_]/g, " ");
    } catch {
      img.alt = "image";
    }

    // Critical: only set src when region is open (this function is called on open)
    img.src = href;

    a.appendChild(img);
  }
}


  function fetchText(url) {
    if (!fetchCache.has(url)) {
      fetchCache.set(url, fetch(url, { cache: "force-cache" }).then(r => {
        if (!r.ok) throw new Error(`HTTP ${r.status}`);
        return r.text();
      }));
    }
    return fetchCache.get(url);
  }

  function extractForEmbed(htmlText) {
    const parser = new DOMParser();
    const doc = parser.parseFromString(htmlText, "text/html");

    // Remove scripts for safety and to avoid side-effects.
    doc.querySelectorAll("script").forEach(s => s.remove());

    // Collect inline <style> blocks.
    const styles = Array.from(doc.querySelectorAll("style"))
      .map(s => s.textContent || "")
      .join("\n");

    // Remove styles/links from body so they don't pollute the parent page.
    doc.body.querySelectorAll("style, link[rel='stylesheet']").forEach(n => n.remove());

    return { styles, content: doc.body.innerHTML, title: doc.title || "" };
  }

  function isSecondaryLink(a) {
    const href = a.getAttribute("href") || "";
    if (!href) return false;
    if (IMG_RE.test(href)) return false;

    return (
      SECONDARY_RE.test(href) ||
      a.dataset.secondary === "1" ||
      a.classList.contains("secondary-link")
    );
  }

  function ensureSecondaryPreviewUI(a) {
    const li = a.closest("li");
    if (!li) return;
    if (li.querySelector(":scope > details.secondary")) return;

    const href = a.getAttribute("href");

    const details = document.createElement("details");
    details.className = "secondary";

    // Minimal UI; embed area is filled on demand.
    details.innerHTML = `
      <summary>Inline preview</summary>
      <div class="secondary-status">Not loaded.</div>
      <div class="secondary-embed" data-href="${href.replace(/"/g, "&quot;")}"></div>
    `;

    li.appendChild(details);

    details.addEventListener("toggle", async () => {
      if (!details.open) return;

      const embed = details.querySelector(".secondary-embed");
      if (!embed || embed.dataset.loaded === "1") return;

      // Important: only load if the enclosing region is open (your requirement).
      const region = details.closest("details.region");
      if (!region || !region.open) return;

      const status = details.querySelector(".secondary-status");
      const url = embed.dataset.href;

      try {
        status.textContent = "Loading…";
        const htmlText = await fetchText(url);
        const { styles, content } = extractForEmbed(htmlText);

        // Shadow DOM isolates the embedded page's CSS so it doesn't leak into the parent.
        if (embed.attachShadow) {
          const root = embed.attachShadow({ mode: "open" });
          root.innerHTML = `
            <style>
              :host { display: block; }
              /* light reset inside the embedded view */
              body { margin: 0; }
            </style>
            <style>${styles}</style>
            <div class="embedded">${content}</div>
          `;
        } else {
          // Fallback: no isolation (older browsers).
          embed.innerHTML = `<div class="embedded">${content}</div>`;
        }

        embed.dataset.loaded = "1";
        status.textContent = "Loaded.";
      } catch (err) {
        status.textContent = `Failed to load (${url}): ${err.message || err}`;
      }
    });
  }

  function convertRegionSectionsToDetails() {
    document.querySelectorAll("section").forEach(sec => {
      const h3 = sec.querySelector(":scope > h3");
      const ul = sec.querySelector(":scope > ul");
      if (!h3 || !ul) return;

      const title = (h3.textContent || "").trim();
      if (!/^Region\b/i.test(title)) return;

      const details = document.createElement("details");
      details.className = "region";
      if (sec.getAttribute("style")) details.setAttribute("style", sec.getAttribute("style"));

      const summary = document.createElement("summary");
      summary.textContent = title;

      const body = document.createElement("div");
      body.className = "region-body";

      // Move <ul> into the dropdown body.
      body.appendChild(ul);

      details.appendChild(summary);
      details.appendChild(body);

      // Replace the entire section (drops the old h3).
      sec.replaceWith(details);
    });
  }

  async function onRegionOpen(regionDetails) {
  if (regionDetails.dataset.hydrated === "1") return;
  regionDetails.dataset.hydrated = "1";

  // NEW: turn image links into thumbnails (only loads now, on open)
  hydrateImageThumbnails(regionDetails);

  // Keep your existing HTML-inline-preview behaviour (if you still want it)
  const anchors = Array.from(regionDetails.querySelectorAll("a[href]"))
    .filter(isSecondaryLink);

  anchors.forEach(ensureSecondaryPreviewUI);

  if (PRELOAD_ON_REGION_OPEN) { /* unchanged */ }
}


  document.addEventListener("DOMContentLoaded", () => {
    convertRegionSectionsToDetails();

    document.querySelectorAll("details.region").forEach(d => {
      d.addEventListener("toggle", () => {
        if (d.open) onRegionOpen(d);
      });
    });
  });
})();
</script>

</body></html>
