<!doctype html>
<html lang="en"><head><meta charset="utf-8"><title>Image Context 82abb4a7afa6316c</title>
<style>
body{font:14px/1.4 -apple-system,Segoe UI,Roboto,sans-serif;max-width:900px;margin:24px auto;padding:0 16px;color:#222}
h1{font-size:18px;margin:0 0 12px 0}
h2{font-size:16px;margin:16px 0 8px}
h3{font-size:14px;margin:10px 0 4px}
code,pre{background:#f6f8fa;padding:2px 4px;border-radius:4px}
figure{margin:10px 0;padding:8px;border:1px solid #e6e6e6;border-radius:8px}
figcaption{color:#555;font-size:12px;margin-top:6px}
pre {
  white-space: pre-wrap;     /* allow wrapping inside <pre> */
  overflow-wrap: anywhere;   /* break very long words/URLs */
  word-break: break-word;    /* fallback for older engines */
  max-width: 68ch;           /* ~68 characters line length */
  margin: 0 auto 10px;       /* center the block */
  line-height: 1.5;
}

figcaption {
  max-width: 68ch;           /* keep the sentence narrow */
  margin: 6px auto 0;        /* center under the image */
  white-space: normal;       /* ensure wrapping */
  overflow-wrap: anywhere;
  word-break: break-word;
  line-height: 1.5;
}
</style>
</head><body>
  <h1>Image context</h1>
  <p><strong>Search input:</strong></p>
  <pre>Truncating spiral stair with a steadily reducing width towards the top, whilst maintaining a constant diameter of the stair 'eye' or central void.</pre>
  <p><strong>Search mode:</strong> paragraph_v &nbsp; <strong>Targeting:</strong> 1.5×</p>

  <h2>Selected image</h2>
  <figure>
    <img src="https://pd12m.s3.us-west-2.amazonaws.com/images/160c7c2e-93bd-5467-a6e7-640f8b959044.jpeg" alt="" style="max-width:100%;height:auto;">
    <figcaption>Region 0 — normative, defy</figcaption>
  </figure>

  <h2>All regions</h2>
  <section style="margin:16px 0;"><h3 style="margin:6px 0;">Region 0 — dyeing, homemaker, laundering, pipe, flywheel, flywheel, pipe, confront, feminist, speakerphone, shoplifting, shoplifting, quotation, quotation, confront, normative, defy, scribbler, canvas, scribbler, canvas, flocking, painted, painted, luxurious, plunger, ironmonger, hydrate, pipe, textile, canvas, homemaker, shoplifting, scribbler, bookshelf, bookshelf, scribbler, flywheel, dyeing, ironmonger, scribbler</h3><ul style="margin:6px 0 0 18px;"><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/3899b071-bd95-5cbb-94c1-35eb596c111c.png" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/3899b071-bd95-5cbb-94c1-35eb596c111c.png</a> — dyeing, homemaker, laundering</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/3ec584f7-13d5-5189-92b5-326377b46f5a.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/3ec584f7-13d5-5189-92b5-326377b46f5a.jpeg</a> — pipe, flywheel</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/06d3a786-5b25-5d9f-a939-267f4e07cfc1.png" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/06d3a786-5b25-5d9f-a939-267f4e07cfc1.png</a> — flywheel, pipe</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/d236f300-d201-587a-bc18-887cfeda0531.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/d236f300-d201-587a-bc18-887cfeda0531.jpeg</a> — confront, feminist</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/88face01-b656-596e-8735-0d7ca2f1f5c2.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/88face01-b656-596e-8735-0d7ca2f1f5c2.jpeg</a> — speakerphone, shoplifting</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/9f98fb51-9230-55dd-8371-f1f96ac88ea4.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/9f98fb51-9230-55dd-8371-f1f96ac88ea4.jpeg</a> — shoplifting, quotation</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/837293e6-fe56-55e9-84f9-c948a0f63ac5.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/837293e6-fe56-55e9-84f9-c948a0f63ac5.jpeg</a> — quotation, confront</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/160c7c2e-93bd-5467-a6e7-640f8b959044.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/160c7c2e-93bd-5467-a6e7-640f8b959044.jpeg</a> — normative, defy</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/6f1670c4-58f2-54b1-931f-63e25aa08107.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/6f1670c4-58f2-54b1-931f-63e25aa08107.jpeg</a> — scribbler, canvas</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/8a658878-2c21-5239-adc3-933443b3271c.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/8a658878-2c21-5239-adc3-933443b3271c.jpeg</a> — scribbler, canvas</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/b5849ebb-9709-5dd8-b395-feb290bb580f.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/b5849ebb-9709-5dd8-b395-feb290bb580f.jpeg</a> — flocking, painted</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/4b313df5-b985-59af-826d-40763065011c.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/4b313df5-b985-59af-826d-40763065011c.jpeg</a> — painted, luxurious</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/4fd826ca-a266-560b-833d-ddf961d8e90d.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/4fd826ca-a266-560b-833d-ddf961d8e90d.jpeg</a> — plunger, ironmonger</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/94d6c39d-60c2-5c77-8c55-9b57fa088922.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/94d6c39d-60c2-5c77-8c55-9b57fa088922.jpeg</a> — hydrate, pipe</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/63cc2b02-24b1-5903-8860-8a40620ff9eb.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/63cc2b02-24b1-5903-8860-8a40620ff9eb.jpeg</a> — textile, canvas</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/1b7556af-4ea6-5c43-a088-67470f457dc4.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/1b7556af-4ea6-5c43-a088-67470f457dc4.jpeg</a> — homemaker, shoplifting</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/7823b725-3615-5daf-b466-ed33d74472c5.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/7823b725-3615-5daf-b466-ed33d74472c5.jpeg</a> — scribbler, bookshelf</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/40352f5d-38ae-5fb7-9f66-cb1b99c9f633.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/40352f5d-38ae-5fb7-9f66-cb1b99c9f633.jpeg</a> — bookshelf, scribbler</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/64400de0-9d55-5580-835b-c9b9d30e0a7a.png" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/64400de0-9d55-5580-835b-c9b9d30e0a7a.png</a> — flywheel, dyeing</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/4944a1a8-76fa-55ef-918c-d42bba5c2020.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/4944a1a8-76fa-55ef-918c-d42bba5c2020.jpeg</a> — ironmonger, scribbler</li></ul></section>
<section style="margin:16px 0;"><h3 style="margin:6px 0;">Region 1 — ventilation, locked, green, coloring, noticing, green, staffing, hostel, pyjama, ornithology, noticing, bickering, ventilation, respirator, infiltrate, locked, drugstore, melting, inflated, pollute, respirator, radius, converging, sifting, dimensional, waterfall, hydrant, sifting, waterfall, decorate, inflated, drugstore, hostel, obituary, advisedly, garbage, trash, radius, gravitational, ornithology, decorate, hydrant, caretaker, belong, stay</h3><ul style="margin:6px 0 0 18px;"><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/94efc736-2594-5a8d-9068-2a8ab92c1adb.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/94efc736-2594-5a8d-9068-2a8ab92c1adb.jpeg</a> — ventilation, locked, green</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/c90083a0-2b9a-52cd-b124-ed5f8f0645e5.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/c90083a0-2b9a-52cd-b124-ed5f8f0645e5.jpeg</a> — coloring, noticing, green</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/d804fa96-7683-5cfe-a4a4-26b157a7c040.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/d804fa96-7683-5cfe-a4a4-26b157a7c040.jpeg</a> — staffing, hostel, pyjama</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/f5106b3f-fe07-5f88-aeea-4455b3016d76.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/f5106b3f-fe07-5f88-aeea-4455b3016d76.jpeg</a> — ornithology, noticing, bickering</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/3cc09b9d-4a63-5658-a175-752f60b85ffa.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/3cc09b9d-4a63-5658-a175-752f60b85ffa.jpeg</a> — ventilation, respirator, infiltrate</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/4cebb255-180d-536f-ba32-d1b987160cc3.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/4cebb255-180d-536f-ba32-d1b987160cc3.jpeg</a> — locked, drugstore</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/e48a19ba-70e9-59a2-baa5-324b0cddae45.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/e48a19ba-70e9-59a2-baa5-324b0cddae45.jpeg</a> — melting, inflated</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/64bdc94b-bb0e-5eac-bde9-b3dcf353312c.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/64bdc94b-bb0e-5eac-bde9-b3dcf353312c.jpeg</a> — pollute, respirator</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/b8ce8072-6195-5827-9b7f-5be55a62522c.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/b8ce8072-6195-5827-9b7f-5be55a62522c.jpeg</a> — radius, converging</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/e71366fb-fbf7-5040-8449-a99515b35a19.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/e71366fb-fbf7-5040-8449-a99515b35a19.jpeg</a> — sifting, dimensional</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/387e433b-e0a8-5aba-b67b-868449f5c2b8.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/387e433b-e0a8-5aba-b67b-868449f5c2b8.jpeg</a> — waterfall, hydrant</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/acd34319-630e-5fb7-9b70-d259b8ca375a.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/acd34319-630e-5fb7-9b70-d259b8ca375a.jpeg</a> — sifting, waterfall</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/46cbc4f3-2895-53ef-84ff-eff92e06fd6b.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/46cbc4f3-2895-53ef-84ff-eff92e06fd6b.jpeg</a> — decorate, inflated</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/e953be21-1424-523b-ae5d-cbfbf0704206.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/e953be21-1424-523b-ae5d-cbfbf0704206.jpeg</a> — drugstore, hostel</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/f7dbfdc8-7554-5608-b499-40745519b5d1.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/f7dbfdc8-7554-5608-b499-40745519b5d1.jpeg</a> — obituary, advisedly</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/d29fcb07-7781-5e2a-875b-1ffab833b95d.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/d29fcb07-7781-5e2a-875b-1ffab833b95d.jpeg</a> — garbage, trash</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/2081793f-2221-5668-84ee-948914354fd0.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/2081793f-2221-5668-84ee-948914354fd0.jpeg</a> — radius, gravitational</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/013928ed-26b3-5d73-8c54-f31a366b2855.png" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/013928ed-26b3-5d73-8c54-f31a366b2855.png</a> — ornithology, decorate</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/f022ea92-9f36-506f-b581-a4dc53fc9da8.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/f022ea92-9f36-506f-b581-a4dc53fc9da8.jpeg</a> — hydrant, caretaker</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/29ae7a93-768a-5ed7-b282-00ad1f682f16.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/29ae7a93-768a-5ed7-b282-00ad1f682f16.jpeg</a> — belong, stay</li></ul></section>
<section style="margin:16px 0;"><h3 style="margin:6px 0;">Region 2 — park, oleander, rue, rue, sidewalk, park, crowded, sidewalk, spacious, spacious, crowded, stomp, heir, floorboard, boy, bodega, flowery, oleander, passenger, steamer, floorboard, steaming, steamer, harbor, mussel, infiltrating, scallop, boy, heir, insole, footprint, bodega, tenth, decipher, script, executing, massacre, executing, massacre, amnesia, flowery, decipher, letter, undersigned, script, infiltrating, shotgun, amnesia, stomp</h3><ul style="margin:6px 0 0 18px;"><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/af27faa7-69ce-5225-aec8-5c19cc217136.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/af27faa7-69ce-5225-aec8-5c19cc217136.jpeg</a> — park, oleander, rue</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/72b7add1-be9f-5291-a5ef-6ab9eaee118b.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/72b7add1-be9f-5291-a5ef-6ab9eaee118b.jpeg</a> — rue, sidewalk, park</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/df204741-3251-51dd-a652-c1600aafbee2.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/df204741-3251-51dd-a652-c1600aafbee2.jpeg</a> — crowded, sidewalk, spacious</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/4dca25a5-f3b8-5fd6-8e3a-858d4447f931.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/4dca25a5-f3b8-5fd6-8e3a-858d4447f931.jpeg</a> — spacious, crowded, stomp</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/e2eedfbd-0d24-5667-b620-43f51be3eaf5.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/e2eedfbd-0d24-5667-b620-43f51be3eaf5.jpeg</a> — heir, floorboard, boy</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/b7a48cd8-c286-5f99-9fae-be5e54909e6a.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/b7a48cd8-c286-5f99-9fae-be5e54909e6a.jpeg</a> — bodega, flowery, oleander</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/1e42a8fc-3941-517d-bfa1-3838e0881272.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/1e42a8fc-3941-517d-bfa1-3838e0881272.jpeg</a> — passenger, steamer, floorboard</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/bac89440-4939-543c-b43b-b497eca48097.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/bac89440-4939-543c-b43b-b497eca48097.jpeg</a> — steaming, steamer, harbor</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/d1d92bff-4d88-5a77-99e7-56678d2214b3.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/d1d92bff-4d88-5a77-99e7-56678d2214b3.jpeg</a> — mussel, infiltrating, scallop</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/d1d3a727-1d62-5eb8-bb3f-649fe0086a61.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/d1d3a727-1d62-5eb8-bb3f-649fe0086a61.jpeg</a> — boy, heir</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/e27420f1-d0b4-5435-a26e-d5a6d3afee13.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/e27420f1-d0b4-5435-a26e-d5a6d3afee13.jpeg</a> — insole, footprint</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/166823b5-c94b-5805-927b-7238b5ef6040.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/166823b5-c94b-5805-927b-7238b5ef6040.jpeg</a> — bodega, tenth</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/4fb5ae73-e764-59bd-a7b7-6abd6cb07617.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/4fb5ae73-e764-59bd-a7b7-6abd6cb07617.jpeg</a> — decipher, script</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/0034c49b-618a-59fd-a1e5-685c8b2089ae.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/0034c49b-618a-59fd-a1e5-685c8b2089ae.jpeg</a> — executing, massacre</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/200583fa-33f3-5ab9-9099-8302fbb691f5.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/200583fa-33f3-5ab9-9099-8302fbb691f5.jpeg</a> — executing, massacre</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/574d4368-29a2-5aec-a6ee-6f9332ced9a1.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/574d4368-29a2-5aec-a6ee-6f9332ced9a1.jpeg</a> — amnesia, flowery</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/14c4232b-a76f-584a-943a-17bf9a08b7ea.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/14c4232b-a76f-584a-943a-17bf9a08b7ea.jpeg</a> — decipher, letter</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/a39665fc-6a6c-5691-8eb7-cfdec7eb4fe8.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/a39665fc-6a6c-5691-8eb7-cfdec7eb4fe8.jpeg</a> — undersigned, script</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/1891fa70-4f8f-5620-9a91-55b2877a885a.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/1891fa70-4f8f-5620-9a91-55b2877a885a.jpeg</a> — infiltrating, shotgun</li><li><a href="https://pd12m.s3.us-west-2.amazonaws.com/images/bace1259-d442-5210-af47-126a06cea3b8.jpeg" target="_blank">https://pd12m.s3.us-west-2.amazonaws.com/images/bace1259-d442-5210-af47-126a06cea3b8.jpeg</a> — amnesia, stomp</li></ul></section>
<style>
  /* Region dropdowns */
  details.region {
    margin: 16px 0;
    border: 1px solid #e6e6e6;
    border-radius: 10px;
    padding: 8px 10px;
    background: #fff;
  }
  details.region > summary {
    cursor: pointer;
    font-weight: 600;
    list-style: none;
    outline: none;
  }
  details.region > summary::-webkit-details-marker { display: none; }
  details.region[open] > summary { margin-bottom: 8px; }

  /* Secondary (inline preview) dropdowns under each link */
  details.secondary {
    margin-top: 6px;
    border-left: 3px solid #e6e6e6;
    padding-left: 10px;
  }
  details.secondary > summary {
    cursor: pointer;
    font-size: 12px;
    color: #444;
    list-style: none;
    outline: none;
  }
  details.secondary > summary::-webkit-details-marker { display: none; }

  .secondary-status {
    font-size: 12px;
    color: #666;
    margin: 6px 0;
  }
  .secondary-embed {
    border: 1px solid #eee;
    border-radius: 8px;
    padding: 8px;
    overflow: auto;
    max-height: 70vh;
    background: #fafafa;
  }
  details.region ul { padding-left: 0; }
  details.region li {
    list-style: none;
    display: flex;
    gap: 10px;
    align-items: flex-start;
    margin: 10px 0;
  }

  a.thumb-link { display: inline-block; }
  img.thumb {
    display: block;
    width: 140px;          /* tweak as desired */
    height: auto;
    border: 1px solid #e6e6e6;
    border-radius: 10px;
    background: #fff;
  }

  /* If you want the caption text to wrap nicely next to the thumb */
  .thumb-caption {
    line-height: 1.25;
  }
</style>

<script>
(() => {
  /**
   * Controls behaviour:
   * - If true: when a REGION opens, prefetch all secondary HTML previews in that region.
   * - If false (default): only fetch when the per-link “Inline preview” dropdown is opened
   *   (still satisfies “only when region is expanded”, because you can’t open the preview otherwise).
   */
  const PRELOAD_ON_REGION_OPEN = false;

  // Consider a link “secondary HTML” if it ends with .html/.htm/.xhtml
  // OR if you explicitly mark it with class="secondary-link" or data-secondary="1".
  const SECONDARY_RE = /\.(?:xhtml|html?|htm)(?:[?#].*)?$/i;
  const IMG_RE = /\.(?:png|jpe?g|gif|webp|svg)(?:[?#].*)?$/i;

  // Cache fetches so repeated opens don't refetch the same page.
  const fetchCache = new Map(); // url -> Promise<string>

  function hydrateImageThumbnails(regionDetails) {
  const anchors = Array.from(regionDetails.querySelectorAll("a[href]"));

  for (const a of anchors) {
    const href = a.getAttribute("href") || "";
    if (!IMG_RE.test(href)) continue;

    // If already an image (e.g., you manually made one), skip.
    if (a.querySelector("img")) continue;

    // Make the link open the full image in a new tab (optional but usually nicer)
    a.target = "_blank";
    a.rel = "noopener";
    a.classList.add("thumb-link");

    // Preserve any trailing text after the link (your " — tags" etc.)
    // by wrapping it into a span so layout stays clean.
    const li = a.closest("li");
    if (li) {
      // Everything after the <a> currently sits as text nodes in the <li>.
      // We'll keep it, but wrap it so it sits next to the image neatly.
      // Only do this once.
      if (!li.querySelector(":scope > .thumb-caption")) {
        const caption = document.createElement("div");
        caption.className = "thumb-caption";

        // Move all nodes after <a> into caption
        let node = a.nextSibling;
        while (node) {
          const next = node.nextSibling;
          caption.appendChild(node);
          node = next;
        }
        li.appendChild(caption);
      }
    }

    // Replace link text with an <img> thumbnail.
    a.textContent = ""; // removes the URL/filename display

    const img = document.createElement("img");
    img.className = "thumb";
    img.loading = "lazy";
    img.decoding = "async";

    // Alt from filename (basic)
    try {
      const u = new URL(href, window.location.href);
      img.alt = (u.pathname.split("/").pop() || "image").replace(/[-_]/g, " ");
    } catch {
      img.alt = "image";
    }

    // Critical: only set src when region is open (this function is called on open)
    img.src = href;

    a.appendChild(img);
  }
}


  function fetchText(url) {
    if (!fetchCache.has(url)) {
      fetchCache.set(url, fetch(url, { cache: "force-cache" }).then(r => {
        if (!r.ok) throw new Error(`HTTP ${r.status}`);
        return r.text();
      }));
    }
    return fetchCache.get(url);
  }

  function extractForEmbed(htmlText) {
    const parser = new DOMParser();
    const doc = parser.parseFromString(htmlText, "text/html");

    // Remove scripts for safety and to avoid side-effects.
    doc.querySelectorAll("script").forEach(s => s.remove());

    // Collect inline <style> blocks.
    const styles = Array.from(doc.querySelectorAll("style"))
      .map(s => s.textContent || "")
      .join("\n");

    // Remove styles/links from body so they don't pollute the parent page.
    doc.body.querySelectorAll("style, link[rel='stylesheet']").forEach(n => n.remove());

    return { styles, content: doc.body.innerHTML, title: doc.title || "" };
  }

  function isSecondaryLink(a) {
    const href = a.getAttribute("href") || "";
    if (!href) return false;
    if (IMG_RE.test(href)) return false;

    return (
      SECONDARY_RE.test(href) ||
      a.dataset.secondary === "1" ||
      a.classList.contains("secondary-link")
    );
  }

  function ensureSecondaryPreviewUI(a) {
    const li = a.closest("li");
    if (!li) return;
    if (li.querySelector(":scope > details.secondary")) return;

    const href = a.getAttribute("href");

    const details = document.createElement("details");
    details.className = "secondary";

    // Minimal UI; embed area is filled on demand.
    details.innerHTML = `
      <summary>Inline preview</summary>
      <div class="secondary-status">Not loaded.</div>
      <div class="secondary-embed" data-href="${href.replace(/"/g, "&quot;")}"></div>
    `;

    li.appendChild(details);

    details.addEventListener("toggle", async () => {
      if (!details.open) return;

      const embed = details.querySelector(".secondary-embed");
      if (!embed || embed.dataset.loaded === "1") return;

      // Important: only load if the enclosing region is open (your requirement).
      const region = details.closest("details.region");
      if (!region || !region.open) return;

      const status = details.querySelector(".secondary-status");
      const url = embed.dataset.href;

      try {
        status.textContent = "Loading…";
        const htmlText = await fetchText(url);
        const { styles, content } = extractForEmbed(htmlText);

        // Shadow DOM isolates the embedded page's CSS so it doesn't leak into the parent.
        if (embed.attachShadow) {
          const root = embed.attachShadow({ mode: "open" });
          root.innerHTML = `
            <style>
              :host { display: block; }
              /* light reset inside the embedded view */
              body { margin: 0; }
            </style>
            <style>${styles}</style>
            <div class="embedded">${content}</div>
          `;
        } else {
          // Fallback: no isolation (older browsers).
          embed.innerHTML = `<div class="embedded">${content}</div>`;
        }

        embed.dataset.loaded = "1";
        status.textContent = "Loaded.";
      } catch (err) {
        status.textContent = `Failed to load (${url}): ${err.message || err}`;
      }
    });
  }

  function convertRegionSectionsToDetails() {
    document.querySelectorAll("section").forEach(sec => {
      const h3 = sec.querySelector(":scope > h3");
      const ul = sec.querySelector(":scope > ul");
      if (!h3 || !ul) return;

      const title = (h3.textContent || "").trim();
      if (!/^Region\b/i.test(title)) return;

      const details = document.createElement("details");
      details.className = "region";
      if (sec.getAttribute("style")) details.setAttribute("style", sec.getAttribute("style"));

      const summary = document.createElement("summary");
      summary.textContent = title;

      const body = document.createElement("div");
      body.className = "region-body";

      // Move <ul> into the dropdown body.
      body.appendChild(ul);

      details.appendChild(summary);
      details.appendChild(body);

      // Replace the entire section (drops the old h3).
      sec.replaceWith(details);
    });
  }

  async function onRegionOpen(regionDetails) {
  if (regionDetails.dataset.hydrated === "1") return;
  regionDetails.dataset.hydrated = "1";

  // NEW: turn image links into thumbnails (only loads now, on open)
  hydrateImageThumbnails(regionDetails);

  // Keep your existing HTML-inline-preview behaviour (if you still want it)
  const anchors = Array.from(regionDetails.querySelectorAll("a[href]"))
    .filter(isSecondaryLink);

  anchors.forEach(ensureSecondaryPreviewUI);

  if (PRELOAD_ON_REGION_OPEN) { /* unchanged */ }
}


  document.addEventListener("DOMContentLoaded", () => {
    convertRegionSectionsToDetails();

    document.querySelectorAll("details.region").forEach(d => {
      d.addEventListener("toggle", () => {
        if (d.open) onRegionOpen(d);
      });
    });
  });
})();
</script>

</body></html>
